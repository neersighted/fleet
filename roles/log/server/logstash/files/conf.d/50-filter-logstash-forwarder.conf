filter {
  if [type] == "logstash-forwarder" {
    # Discard entries without a timestamp (config).
    grep {
      match => [ "message", "\d{4}\/\d{2}\/\d{2} \d{2}:\d{2}:\d{2}.\d+ .*" ]
    }

    # Strip the timestamp from the message.
    grok {
      match => [ "message", "%{LSFTIMESTAMP:timestamp} %{GREEDYDATA:message}" ]
      overwrite => [ "message" ]
    }


    # Drop the noise.
    if [message] =~ /^Registrar received \d+ events/ {
      drop { }
    }


    date {
      match => [ "timestamp",  "YYYY/MM/dd HH:mm:ss.SSSSSS" ]
      remove_field => [ "timestamp" ]
    }
  }
}
