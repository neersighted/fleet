#!/usr/bin/env bash

HASHES='sha1 sha256'
CIPHERS='rsa dsa ecdsa'

c=1

for cipher in $CIPHERS; do
  h=1

  for hash in $HASHES; do
    test -f /etc/ssh/ssh_host_${cipher}_key.pub || continue

    fp=$(awk '{print $2}' /etc/ssh/ssh_host_${cipher}_key.pub | openssl base64 -d -A | openssl dgst -${hash} | awk '{print $2}' | tr '[a-z]' '[A-Z]')

    echo "$(hostname -f). IN SSHFP ${c} ${h} ${fp}"

    ((h++))
  done
  ((c++))
done
