#!/usr/bin/env bash

HASHES='sha1 sha256'
CIPHERS='rsa dsa ecdsa'

host=$1

c=1
for cipher in $CIPHERS; do
  h=1
  for hash in $HASHES; do
    fingerprint=$(ssh-keyscan -t "${cipher}" "${host}" 2>/dev/null | \
                  awk '{print $3}' | \
                  base64 -d | \
                  ${hash}sum | \
                  awk '{print $1}' \
                )

    sshfp="${c} ${h} ${fingerprint}"

    echo "${host}. SSHFP ${sshfp}"

    ((h++))
  done
  ((c++))
done
